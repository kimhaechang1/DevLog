# Nov. 07. 2022 commit

적용 프로젝트 : [bePro](https://github.com/kimhaechang1/bePro)

작성 날짜 : Nov. 25. 2022

## 개발 내용
> ### 메인 페이지 구성요소 수정
>
> 메인페이지의 구성요소중 '최근 사용한 용어' 는 '용어사전' 요소를 회의에서 뺏으므로 삭제한다.
>
> 또한 검색창의 위치를 상단바 인 ```Header.js```에서 ```MainPage.js```의 ```Card``` 컴포넌트들 위로 옮기고 
> 
> 기존의 돋보기의 용도를 '검색' 버튼용도로 교체한다.
> 
> 또한 드롭다운 미리보기 용 ```<SearchDropDown>```컴포넌트 도 검색창 바로 아래에 위치하도록 옮긴다.

<br>

> ### Tagify.js 사용과 실패
>
> 참고 자료 
> 
> [Tagify react example](https://codesandbox.io/s/oempc?file=/src/MixedModeTagify.jsx)
> 
> 초기 회의에서는 태그+검색어를 이용하여 검색 기능을 구현하는것을 생각하였다.
> 
> ex) [#C언어] 를 잘하는 방법
> 
> 이를 구현하기 편하게 도와주는 모듈이 ```Tagify.js``` 였고, 이를 설치 후 사용하여 ```ReactTagify.js```라는 컴포넌트로 구현 해 보았으나
> 
> 왜인지 몰라도 드롭다운 미리보기가 작동하지 않았다.
> 
> ```Tagify.js```는 ```<Tag>``` 컴포넌트를 사용하며, ```settings```속성을 사용하여 커스터마이징이 가능하다.
>
> 그래서 ```settings```속 드롭다운 사용을 dropdown 값을 통해 조정 가능하고, 드롭다운 리스트는 whitelist를 통해 만들 수 있는데
>
> 이를 아무리 설정해도 드롭다운 미리보기가 작동하지 않았다.
> 
> 따라서 검색어 + 태그를 사용하여 검색하는 기능 대신 태그를 검색창 아래에 추가 하는 방식을 채택했다.
>
> 이에 따라 필요없어진 모듈은 삭제했다. 
>
> 따라서 태그 검색기능 방식을 정한 후 검색기능 작동방식은 다음과 같다.
>
> 1. 사용자가 입력창에 검색어를 입력한다. 여기서 검색어와 비슷한 태그들은 드롭다운 방식으로 제공된다.
> 2. 이 때 드롭다운으로 제공될 태그 리스트는 검색어의 길이가 2 이상인 경우  ```GET```방식으로 받아온다.
> 3. 여기서 드롭다운 미리보기 중 하나를 누를 시 검색창 아래에 태그가 추가 된다. 중복된 태그는 허용하지 않는다.
> 4. 태그들과 검색어를 이용하여 돋보기 버튼을 누를시 ```POST``` 방식으로 서버에 두가지 데이터가 전송된다.
> 5. 서버는 DB에 프론트로 받은 데이터를 조회하여 해당하는 글 목록들을 응답데이터로 전송한다.
> 6. 프론트에서는 응답데이터중 글 목록 데이터를 ```useNavigate```를 사용하여 검색결과 페이지로 넘기고 검색결과 페이지로 이동된다.
> 7. 검색결과 페이지는 글목록을 화면에 나타낸다.
  
<br>

> ### 직접 태그기능 구현하기
> 
> **MainPage.js**
> 
> 메인페이지에서는 두 가지 데이터(검색어, 태그)를 분리하여 저장해야 하므로
>
> 두가지 ```useState ```를 만들고 하나는 태그리스트 저장용, 다른 하나는 검색창 ```input``` 태그의 ```onChange``` 이벤트와 연결하였다.
> ```jsx
> const [value, setValue] = useState("") // input 용
> const [hashtag, setHashtag] = useState([]) // 태그리스트 용
> ```
> 
> 그리고 태그들을 드롭다운으로 미리보기를 제공하기 위해선 입력값을 감지 하여야 한다.
>
> 또한 목록에 있는 태그를 추가하기 위해선 ```setHashtag``` 함수 제공 및 중복태그 검사를 위해 현재 태그들의 목록을 알아야 한다. 
>
> 따라서 이러한 필요한 값들과 함수를 ```<SearchDropDown>``` 컴포넌트의 속성으로 넘긴다.
>
> 마지막으로 ```hashtag``` 속 태그들을 입력창 아래부분에서 map 함수를 통해 화면에 뿌려준다.
>
> **axiosGetHashTag.js**
> 
> 태그들을 서버로부터 ```GET```방식으로 미리 받아와야 하므로 ```axios.get```을 통해 받아와서 응답 프로미스 객체를 리턴한다.
>
> 현재는 아직 태그들을 모아오는 기능이 서버에 없으므로, 임시 태그목록을 만들어서 리턴 시켰다.
>
> **SearchDropDown.js**
> 
> 드롭다운 미리보기는 초기에 렌더링 후 사용자의 입력값의 길이를 검사하여 태그 목록을 보여주어야 하므로  ```useEffect```를 사용한다.
>
> 그리고 사용자의 입력값과 비슷한 태그들을 ```useState```를 통해 저장한다.
> ```jsx
> const [supportData, setSupportData] = useState([]);
> ```
> 결론적으로 로직을 구성하면, ```useEffect```속에서 입력값 길이를 검사하고 미리 태그들을 ```axiosGetHashtag```함수를 통해 받아와서 
>
> ```setSupportData```를 통해 임시저장한다.
>
> 그리고 ```supportData.fitler```를 통해 내부를 순회하면서 includes를 통해 입력값과 비슷한 태그들을 사용한 배열을 구성하고 
>
> ```setSupportData```를 통해 저장한다.
>
> 마지막으로 저장된 ```supportData```값을 ```map```함수를 사용하여 태그 목록을 렌더링하도록 리턴한다.
>
> 여기서 태그들 마다 onClick이벤트를 걸고 ```onClickHandler``` 헨들러함수를 정의한다. 
>
> > **onClickHandler**
> > 
> > 여기서는 props를 통해 넘어온 현재 태그들과 지금 추가하려는 태그를 비교하여 중복된 태그가 있는지 검사하고
> >
> > 없으면 현재 태그목록과 추가하려는 태그를 가지고 새로운 배열을 만들어 태그리스트(```MainPage.js``` 의 ```hashtag```)에 추가한다.

<br>

후기

생각외로 태그 기능을 구현하는데 많은 어려움이 있었다.
  
태그기능을 추가히기 전날에 자기전에 ```Tagify.js``` 을 보고 "이야, 역시 이런것 까지 미리 구현된 모듈이 있구나" 해서 좋았지만
  
쉬워보이는건 언제나 그 속이 쉽지않았다. 역시 직접 구현해보는게 공부도되고 훨씬 편하다
