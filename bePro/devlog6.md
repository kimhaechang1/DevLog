# Oct. 28. 2022 commit

적용 프로젝트 : [bePro](https://github.com/kimhaechang1/bePro)

작성 날짜 : Nov. 23. 2022

## 개발 내용
> ### 회원가입 로직 구현
>
> **회원가입 진행순서**
> 
> 1. 사용자가 입력한 값을 ```axiosSignUpData()```를 통해 서버로 전송    
> 2. 서버에서는 DB에 프론트에서 넘겨받은 데이터를 저장
> 3. 회원가입에 성공했을 경우 서버에서 회원가입 성공/실패여부, 회원가입 관련 메시지를 응답데이터로 보낸다.
> 4. 프론트단에서 회원가입에 성공했을 경우 곧바로 로그인에 시도한다
> 
> **axiosSignUp.js**
>
> 로그인 로직과 비슷하나, 프론트단 단독으로 테스트하기에는 무리가 있으므로 axios 모듈을 사용한 로직 구현
> 
> ```axios.post```방식으로 전송하며, 응답 프로미스 객체를 리턴
> 
> **SignUp.js**
>
> 사용자로 부터 입력받을 수 있는 ```<input>``` 태그들을 ```<form>``` 태그로 감싸고    
> 
> 로그인로직과 동일하게 ```useState```, ```onSubmit```, ```onSubmitHandler```를 정의한다.
> 
> ```onSubmitHandler```에서 리턴받은 프로미스 객체를 ```.then```을 통해 객체 속 값을 꺼내어
> 
> 회원가입에 성공했을 경우 ```useState```속 아이디와 패스워드를 곧바로 ```axiosLoginData```의 인자로 넘겨서 로그인로직을 수행한다.
>

<br>

> ### 로그아웃
> 
> **로그아웃 진행순서**
> 
> 1. 사용자가 상단바의 'SignOut' 버튼을 누를 시 ```onClick``` 이벤트가 호출되고, 이벤트 핸들러 함수 속에서 ```axiosSignOut```함수 호출
> 2. ```axiosSignOut```은 ```GET``` 방식을 사용하여 서버에 로그아웃 요청을 보냄
> 3. 서버에서는 DB상에 해당유저의 토큰을 지우고 응답데이터로 로그아웃 성공여부와 로그아웃 관련 메시지를 전송
> 4. 프론트단에서는 응답데이터에 따른 로그아웃 성공여부를 판단하고, 로그아웃 성공 시 로컬 스토리지에 ```key : token```로 된 값을 지워버린다.
> 
> **axiosSignOut.js**
> 
> 혹시나 로그아웃이 되었는데도 불구하고 ```Header.js```에서 로그인 된 상단메뉴가 보일 수 있으므로
> 
> 먼저 로컬스토리지에 값이 존재하는지 검사를 한다.
>
> 만약 아무런 값도 잡히지 않는다면, "이미 로그아웃 된 상태입니다." 라는 ```alert```를 보내고 ```false```를 리턴시킨다.
>
> 그리고 정상적으로 로그아웃 로직을 수행한다면, ```axios.get```을 통해 해당유저의 로그아웃 요청을 서버에 보내고
> 
> 응답 프로미스 객체를 리턴 받는데, 여기서 바로 ```.then```을 통해 객체 속 값을 분석하여
>
> 로그아웃에 성공하였을 때 로컬 스토리지에 값을 지워버린 후 ```true```를 리턴시킨다.
> 
> 만약 통신상에 에러가 발생 할 경우도 있기 때문에 ```.catch```문을 통해 우선에는 에러 메시지를 ```alert``` 하도록 처리한다.
>
> **Header.js**
>
> **참고자료**
>
> [Link & useNavigate](https://velog.io/@seokkitdo/React-Link-useNavigate)
> 
> [react에서 navigate사용하기](https://basemenks.tistory.com/m/278)
> 
>
> 랜더링 되어지는 ```return```문 속 'SignOut' 버튼에 ```onClick``` 이벤트를 걸고 이벤트 헨들러 함수로 ```signOutHandler()```를 정의한다.
>
> > **signOutHandler()**
> >
> > 위 함수의 리턴값이 ```true```일 경우는 정상적으로 로그아웃을 수행했으므로 ```useNavigate```를 사용하여 화면을 리다이렉팅 한다.
  
<br>

> ### 자잘한 고치기
> 
> **로그인 로직 수정**
>
> 기존의 ```axiosLoginData```에서는 ```POST```방식을 통한 전송을 수행 후 프로미스 객체를 리턴 시키고
> 
> 이 객체를 ```SignIn.js```에서 받아서 ```useEffect```를 통해 로컬스토리지에 값들을 저장 할 예정이었으나,
> 
> 그렇게 수행 될 시 회원가입 후 즉시 로그인이 힘들어 진다.
> 
> 따라서 ```axiosLoginData```에서 통신 이후 응답 프로미스 객체를 즉시 분석하여 로컬스토리지에 값들을 저장하도록 변경한다.
> 
> 또한 기존의 리턴 값 방식은 응답 프러미스 속 값들을 다른 객체 변수에 넣어서 리턴시켰는데
> 
> 굳이 그럴 필요성을 못느꼈고 그냥 ```SignIn.js```에서 ```.then```을 통해 분석하는 방식으로 변경하였다.
  
후기
 
아직 ```useHistory```로 잘못 알고 있던 나머지 ```useNavigate``` 를 사용하는데 버벅임이 심하였다.
 
```useEffect```를 제외하고도 ```useNavigate``` 또한 공부가 필요하다.

지금까지 여러가지의 ```axios``` 수행을 하고 응답 객체를 받는데 있어서 그냥 에러 예외처리를 안한 것 같다.

나중에라도 ```.catch```을 통한 에러처리를 똑바로 해야할 것 같다.
